.TH METEOLOOP "1" "December 2001" "Meteo station tools" Othello
.SH NAME
meteoloop \- compute averages of meteo data
.SH SYNOPSIS
meteoloop [
.B \-m
] [
.B \-d
] [
.B \-V
] [
.B \-F
] [
.BI \-l logurl
] [
.BI \-p pidfile
] [
.B \-q
] [
.BI \-r repeats
] [
.B \-n
] [
.BI \-w watchdoginterval
]
.BI \-s stationname
.BI \-f conffile
.SH DESCRIPTION
The 
.BR meteoloop (1)
programm connects to the weather station specified with the 
.B -s
option and the configuration file
.I conffile
and starts reading data from it. It computes averages and extreme values
for all the parameters it finds over a period of one minute, and constructs
an SQL update query to write the information into the database.
Depending on the 
.B \-q
option, the query is either sent directly to the database (as specified
in the configuration file), or to a message queue, where it will later
be picked up by the
.BR meteodequeue (1)
program.
.SH OPTIONS
.TP
.B \-m
run a master and a slave process. The master will just wait for the
child to exit, and immediately spawn a new child. This will ensure
that there always is a child reading data from the meteo station.
.TP
.B \-d
increase the debug level by one. Debug messages are written to standard
error.
.TP
.B \-q
send update queries to a message queue, and not to the database
directly. Since the
.I stationdata
table may be locked during a long running query, 
.BR meteoloop (1)
may loose data from the weather station. The use of the message queue
in conjunction with the
.BR meteodequeue (1)
program thus improves reliabilty and performance by decreasing contention
on the 
.I stationdata
table.
.TP
.BI \-f conffile
Use 
.I conffile
to read the configuration, see 
.BR meteo.xml (5)
for the configuration syntax. This argument is mandatory.
.TP
.B \-F
stay in foreground. Useful during debugging.
.TP
.BI \-l logurl
send log messages to the destination described by the 
.IR logurl .
.TP
.BI \-p pidfile
When running in daemon mode, write the process id of the 
.BR meteoavg (1)
process to this file. Defaults to
.IR /var/run/meteoloop-<station>.pid .
.TP
.BI \-s stationname
Name of the station  from which to read data.
.TP
.BI \-n repeats
Compute only
.I repeats
data points, the default is to run indefinitely.
.TP
.BI \-w watchdoginterval
enable the watchdog timer with an interval of 
.I watchdoginterval
seconds. If no reply is received from the station for an interval of
this duration, the
.BR meteloop (1)
command is restarted with the same arguments.
A watchdoginterval of 0 means that the signal handler is installed, but
not armed. An external programm can be used to signal the ALARM signal
to
.BR meteoloop (1)
and cause it to restart. It is suggested that
.BR meteowatch (1)
be used for that purpose.
Note that the -m option must be used to make sure
.BR meteoloop (1)
knows what to do when the watchdog timer fires.
.TP
.B \-V
print version information and exit.

.SH FILES
.BR meteoloop (1)
writes its process id by default to a file 
.BI /var/run/meteoloop- station .pid

.SH "SEE ALSO"
.BR meteo (1)
.BR meteo.xml (5),
.BR meteoloop (1),
.BR meteograph (1),
.BR meteodequeue (1),
.BR meteojob (1),
.BR meteoavg (1),
.BR meteowatch (1)

.SH AUTHOR
Dr. Andreas Mueller <afm@othello.ch>
